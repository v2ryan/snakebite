<!DOCTYPE html>

<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3Cé™ªä½ éå¹´ä¸NG</title>
    <meta name="description" content="2026å¹´2æœˆéˆä¿®æœˆæ›† â€” è®“ã€3Cã€ä¸å†åªæœ‰å†·æ¼ ï¼Œè€Œæ˜¯å¸¶ä¾†æ„›çš„æº«åº¦">
    <meta property="og:title" content="3Cé™ªä½ éå¹´ä¸NG">
    <meta property="og:description" content="è®“ã€3Cã€ä¸å†åªæœ‰å†·æ¼ ï¼Œè€Œæ˜¯å¸¶ä¾†æ„›çš„æº«åº¦ â€” 2026å¹´2æœˆéˆä¿®æœˆæ›†">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --connect-blue: #2563EB;
            --connect-bg: #EFF6FF;
            --care-red: #DC2626;
            --care-bg: #FEF2F2;
            --calm-green: #16A34A;
            --calm-bg: #F0FDF4;
            --cream: #FFF8F0;
            --cream-dark: #F5E6D0;
            --warm-bg: linear-gradient(180deg, #FFF1E6 0%, #FFF8F0 30%, #FFFFFF 100%);
            --brown-dark: #3E2723;
            --brown: #5D4037;
            --brown-light: #8D6E63;
            --text-dark: #1A1A1A;
            --text-mid: #4A4A4A;
            --text-light: #9E9E9E;
            --border: #F0E6D9;
            --card-shadow: 0 2px 12px rgba(62, 39, 35, 0.08);
            --card-shadow-hover: 0 4px 20px rgba(62, 39, 35, 0.14);
            --radius: 16px;
            --radius-sm: 10px;
            --gold: #C9A84C;
            --red-accent: #C53030;
        }

```
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
        font-family: 'Noto Sans TC', -apple-system, sans-serif;
        background: var(--warm-bg);
        color: var(--text-dark);
        min-height: 100dvh;
        -webkit-font-smoothing: antialiased;
    }

    /* ========== ANIMATIONS ========== */
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(12px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideUp {
        from { opacity: 0; transform: translateY(24px); }
        to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideIn {
        from { opacity: 0; transform: translateX(100%); }
        to { opacity: 1; transform: translateX(0); }
    }
    @keyframes slideOut {
        from { opacity: 1; transform: translateX(0); }
        to { opacity: 0; transform: translateX(100%); }
    }
    @keyframes popIn {
        0% { transform: scale(0.8); opacity: 0; }
        70% { transform: scale(1.05); }
        100% { transform: scale(1); opacity: 1; }
    }
    @keyframes checkmark {
        0% { stroke-dashoffset: 30; }
        100% { stroke-dashoffset: 0; }
    }
    @keyframes progressFill {
        from { width: 0; }
    }
    @keyframes confetti {
        0% { transform: translateY(0) rotate(0deg); opacity: 1; }
        100% { transform: translateY(-60px) rotate(360deg); opacity: 0; }
    }

    /* ========== HEADER ========== */
    .header {
        text-align: center;
        padding: 48px 20px 32px;
        background: linear-gradient(180deg, #FFE8D6 0%, #FFF1E6 100%);
        position: relative;
    }

    .header::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0; right: 0;
        height: 40px;
        background: linear-gradient(180deg, transparent, #FFF8F0);
    }

    .header h1 {
        font-family: 'Noto Serif TC', serif;
        font-size: 32px;
        font-weight: 900;
        color: var(--brown-dark);
        letter-spacing: 2px;
    }

    .header h1 .accent {
        color: var(--red-accent);
        font-size: 36px;
    }

    .header .subtitle {
        font-size: 15px;
        color: var(--brown-light);
        margin-top: 8px;
        letter-spacing: 1px;
    }

    /* ========== MAIN CONTAINER ========== */
    .container {
        max-width: 680px;
        margin: 0 auto;
        padding: 0 16px 40px;
    }

    /* ========== PROGRESS CARD ========== */
    .progress-card {
        background: white;
        border-radius: var(--radius);
        padding: 24px;
        margin: -16px 0 24px;
        position: relative;
        z-index: 2;
        box-shadow: var(--card-shadow);
        text-align: center;
    }

    .progress-card .trophy { font-size: 28px; }

    .progress-card h3 {
        font-size: 16px;
        font-weight: 700;
        color: var(--brown-dark);
        margin: 8px 0 4px;
    }

    .progress-card .desc {
        font-size: 13px;
        color: var(--text-light);
        margin-bottom: 16px;
    }

    .progress-bar-wrap {
        background: #F3F0EB;
        border-radius: 20px;
        height: 8px;
        overflow: hidden;
        margin-bottom: 8px;
    }

    .progress-bar-fill {
        height: 100%;
        border-radius: 20px;
        background: linear-gradient(90deg, var(--calm-green), #22C55E);
        transition: width 0.8s cubic-bezier(0.25, 1, 0.5, 1);
        animation: progressFill 1s ease;
    }

    .progress-stats {
        display: flex;
        justify-content: space-between;
        font-size: 12px;
        color: var(--text-light);
    }

    .progress-stats .count {
        font-weight: 600;
        color: var(--calm-green);
    }

    /* Name input area */
    .name-section {
        display: none;
        margin-top: 16px;
        padding-top: 16px;
        border-top: 1px solid var(--border);
    }

    .name-section.show { display: block; }

    .name-input-row {
        display: flex;
        gap: 8px;
    }

    .name-input-row input {
        flex: 1;
        padding: 10px 14px;
        border: 2px solid var(--border);
        border-radius: var(--radius-sm);
        font-size: 15px;
        font-family: 'Noto Sans TC', sans-serif;
        outline: none;
        transition: border-color 0.2s;
    }

    .name-input-row input:focus {
        border-color: var(--calm-green);
    }

    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 10px 20px;
        border: none;
        border-radius: var(--radius-sm);
        font-size: 14px;
        font-weight: 600;
        font-family: 'Noto Sans TC', sans-serif;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
        white-space: nowrap;
    }

    .btn-primary {
        background: var(--brown-dark);
        color: white;
    }

    .btn-primary:hover { opacity: 0.9; transform: translateY(-1px); }

    .btn-outline {
        background: white;
        color: var(--brown-dark);
        border: 1.5px solid var(--border);
    }

    .btn-outline:hover { border-color: var(--brown-dark); }

    .btn-login {
        width: 100%;
        padding: 12px;
        background: white;
        color: var(--brown-dark);
        border: 2px solid var(--border);
        border-radius: var(--radius-sm);
        font-size: 15px;
    }

    .btn-login:hover { border-color: var(--brown-dark); background: #FAFAFA; }

    .user-greeting {
        display: none;
        font-size: 14px;
        color: var(--brown);
        margin-top: 12px;
    }

    .user-greeting.show { display: block; }
    .user-greeting .name { font-weight: 700; color: var(--red-accent); }

    /* ========== CATEGORY LEGEND ========== */
    .legend {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin: 20px 0;
        flex-wrap: wrap;
    }

    .legend-item {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 14px;
        font-weight: 500;
        color: var(--text-mid);
    }

    .legend-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
    }

    .legend-dot.connect { background: var(--connect-blue); }
    .legend-dot.care { background: var(--care-red); }
    .legend-dot.calm { background: var(--calm-green); }

    /* ========== ACTION BUTTONS ========== */
    .action-buttons {
        display: flex;
        gap: 10px;
        justify-content: center;
        flex-wrap: wrap;
        margin-bottom: 28px;
    }

    .action-buttons .btn {
        font-size: 13px;
        padding: 10px 16px;
        border-radius: 24px;
    }

    .btn-google {
        background: white;
        color: var(--text-dark);
        border: 1.5px solid #E0E0E0;
    }

    .btn-iphone {
        background: white;
        color: var(--text-dark);
        border: 1.5px solid #E0E0E0;
    }

    .btn-line {
        background: #06C755;
        color: white;
        border: none;
    }

    /* ========== CALENDAR GRID (Desktop) ========== */
    .calendar-grid {
        display: none;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
        margin-bottom: 32px;
        background: white;
        border-radius: var(--radius);
        padding: 16px;
        box-shadow: var(--card-shadow);
    }

    @media (min-width: 640px) {
        .calendar-grid { display: grid; }
        .day-list-title { display: none; }
    }

    .cal-header {
        text-align: center;
        font-size: 12px;
        font-weight: 600;
        color: var(--text-light);
        padding: 8px 0;
    }

    .cal-day {
        text-align: center;
        padding: 8px 4px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
        min-height: 48px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2px;
    }

    .cal-day:hover { background: var(--cream); }
    .cal-day.today { background: var(--care-bg); font-weight: 700; }
    .cal-day.checked::after {
        content: 'âœ“';
        position: absolute;
        top: 2px;
        right: 4px;
        font-size: 10px;
        color: var(--calm-green);
        font-weight: 700;
    }

    .cal-day .num {
        font-size: 14px;
        font-weight: 600;
        color: var(--text-dark);
    }

    .cal-day .lunar {
        font-size: 9px;
        color: var(--text-light);
    }

    .cal-day .cat-dots {
        display: flex;
        gap: 2px;
        margin-top: 2px;
    }

    .cat-dot {
        width: 5px;
        height: 5px;
        border-radius: 50%;
    }

    /* ========== DAY LIST (Mobile) ========== */
    .day-list-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 14px;
        font-weight: 600;
        color: var(--brown-light);
        margin-bottom: 12px;
        padding-left: 4px;
    }

    .day-list {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    @media (min-width: 640px) {
        .day-list { gap: 10px; }
    }

    .day-item {
        background: white;
        border-radius: var(--radius);
        padding: 16px 18px;
        display: flex;
        align-items: center;
        gap: 16px;
        box-shadow: var(--card-shadow);
        cursor: pointer;
        transition: all 0.25s;
        animation: slideUp 0.4s ease forwards;
        opacity: 0;
        position: relative;
        overflow: hidden;
    }

    .day-item:hover {
        box-shadow: var(--card-shadow-hover);
        transform: translateY(-2px);
    }

    .day-item.checked {
        border-left: 4px solid var(--calm-green);
    }

    .day-item .date-col {
        text-align: center;
        min-width: 44px;
        flex-shrink: 0;
    }

    .day-item .date-num {
        font-size: 24px;
        font-weight: 700;
        color: var(--red-accent);
        line-height: 1;
    }

    .day-item .date-weekday {
        font-size: 12px;
        color: var(--text-light);
        margin-top: 2px;
    }

    .day-item .divider {
        width: 1px;
        height: 36px;
        background: var(--border);
        flex-shrink: 0;
    }

    .day-item .content-col {
        flex: 1;
        min-width: 0;
    }

    .day-item .lunar-label {
        font-size: 11px;
        color: var(--text-light);
        margin-bottom: 2px;
    }

    .day-item .title {
        font-family: 'Noto Serif TC', serif;
        font-size: 17px;
        font-weight: 700;
        color: var(--text-dark);
        line-height: 1.4;
    }

    .day-item .tags {
        display: flex;
        gap: 6px;
        margin-top: 6px;
        flex-wrap: wrap;
    }

    .tag {
        font-size: 11px;
        font-weight: 600;
        padding: 2px 8px;
        border-radius: 10px;
        letter-spacing: 0.5px;
    }

    .tag.connect { background: var(--connect-bg); color: var(--connect-blue); }
    .tag.care { background: var(--care-bg); color: var(--care-red); }
    .tag.calm { background: var(--calm-bg); color: var(--calm-green); }

    .day-item .arrow {
        color: var(--text-light);
        font-size: 18px;
        flex-shrink: 0;
        transition: transform 0.2s;
    }

    .day-item:hover .arrow { transform: translateX(3px); }

    /* ========== DAY DETAIL PAGE ========== */
    .detail-overlay {
        display: none;
        position: fixed;
        inset: 0;
        z-index: 1000;
        background: white;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
    }

    .detail-overlay.active {
        display: block;
        animation: slideIn 0.35s ease;
    }

    .detail-overlay.closing {
        animation: slideOut 0.3s ease forwards;
    }

    .detail-header {
        position: sticky;
        top: 0;
        background: white;
        border-bottom: 1px solid var(--border);
        padding: 14px 16px;
        display: flex;
        align-items: center;
        gap: 12px;
        z-index: 10;
    }

    .detail-back {
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        border: none;
        background: var(--cream);
        border-radius: 50%;
        cursor: pointer;
        font-size: 18px;
        transition: background 0.2s;
    }

    .detail-back:hover { background: var(--cream-dark); }

    .detail-header-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 17px;
        font-weight: 700;
        color: var(--brown-dark);
        flex: 1;
    }

    .detail-body {
        padding: 24px 20px 100px;
        max-width: 600px;
        margin: 0 auto;
    }

    .detail-date-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: var(--cream);
        border-radius: 24px;
        padding: 6px 16px;
        font-size: 13px;
        color: var(--brown);
        font-weight: 500;
        margin-bottom: 20px;
    }

    .detail-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 28px;
        font-weight: 900;
        color: var(--brown-dark);
        line-height: 1.5;
        margin-bottom: 16px;
    }

    .detail-tags {
        display: flex;
        gap: 8px;
        margin-bottom: 28px;
    }

    .detail-section {
        margin-bottom: 28px;
    }

    .detail-section-label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        font-weight: 700;
        color: var(--brown-light);
        text-transform: uppercase;
        letter-spacing: 1.5px;
        margin-bottom: 12px;
    }

    .detail-section-label::after {
        content: '';
        flex: 1;
        height: 1px;
        background: var(--border);
    }

    .detail-quiet {
        background: var(--calm-bg);
        border-radius: var(--radius);
        padding: 20px;
        font-size: 15px;
        color: var(--text-mid);
        line-height: 1.9;
        border-left: 4px solid var(--calm-green);
    }

    .detail-verse {
        background: linear-gradient(135deg, #FFFBF0, #FFF8E8);
        border-radius: var(--radius);
        padding: 24px;
        border-left: 4px solid var(--gold);
    }

    .detail-verse .verse-text {
        font-family: 'Noto Serif TC', serif;
        font-size: 17px;
        font-weight: 600;
        color: var(--text-dark);
        line-height: 1.9;
        margin-bottom: 8px;
    }

    .detail-verse .verse-ref {
        font-size: 13px;
        color: var(--gold);
        font-weight: 600;
        letter-spacing: 0.5px;
    }

    .detail-prayer {
        background: var(--care-bg);
        border-radius: var(--radius);
        padding: 20px;
        border-left: 4px solid var(--care-red);
    }

    .detail-prayer .prayer-text {
        font-size: 15px;
        color: var(--text-mid);
        line-height: 1.9;
    }

    .detail-checkin-btn {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        width: 100%;
        padding: 16px;
        border-radius: var(--radius);
        font-size: 17px;
        font-weight: 700;
        font-family: 'Noto Sans TC', sans-serif;
        cursor: pointer;
        transition: all 0.3s;
        border: 2px solid var(--calm-green);
        background: white;
        color: var(--calm-green);
        margin-top: 32px;
    }

    .detail-checkin-btn:hover {
        background: var(--calm-bg);
        transform: translateY(-2px);
    }

    .detail-checkin-btn.checked {
        background: var(--calm-green);
        color: white;
        border-color: var(--calm-green);
        pointer-events: none;
    }

    /* ========== TOAST ========== */
    .toast {
        position: fixed;
        top: 24px;
        left: 50%;
        transform: translateX(-50%) translateY(-100px);
        background: var(--brown-dark);
        color: white;
        padding: 12px 24px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 500;
        z-index: 9999;
        transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        box-shadow: 0 8px 32px rgba(0,0,0,0.2);
        white-space: nowrap;
    }

    .toast.show { transform: translateX(-50%) translateY(0); }

    /* ========== FOOTER ========== */
    .footer {
        text-align: center;
        padding: 24px 16px 40px;
        font-size: 12px;
        color: var(--text-light);
    }

    /* ========== CONFETTI ========== */
    .confetti-piece {
        position: fixed;
        width: 8px;
        height: 8px;
        border-radius: 2px;
        z-index: 9998;
        pointer-events: none;
        animation: confetti 1.2s ease forwards;
    }

    /* ========== SCRATCH CARD ========== */
    .scratch-section {
        margin: 24px 0;
    }

    .scratch-section-title {
        font-family: 'Noto Serif TC', serif;
        font-size: 18px;
        font-weight: 700;
        color: var(--brown-dark);
        text-align: center;
        margin-bottom: 6px;
    }

    .scratch-section-desc {
        text-align: center;
        font-size: 13px;
        color: var(--text-light);
        margin-bottom: 16px;
    }

    .scratch-card {
        position: relative;
        width: 100%;
        max-width: 380px;
        margin: 0 auto;
        aspect-ratio: 4 / 5;
        border-radius: var(--radius);
        overflow: hidden;
        box-shadow: var(--card-shadow-hover);
        background: white;
    }

    .scratch-content {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 28px 22px;
        text-align: center;
        background: linear-gradient(160deg, #FFFDF7 0%, #FFF5E6 50%, #FFF0D6 100%);
    }

    .scratch-content .sc-emoji { font-size: 36px; margin-bottom: 12px; }

    .scratch-content .sc-verse {
        font-family: 'Noto Serif TC', serif;
        font-size: 17px;
        font-weight: 600;
        color: var(--text-dark);
        line-height: 1.9;
        margin-bottom: 8px;
    }

    .scratch-content .sc-ref {
        font-size: 13px;
        color: var(--gold);
        font-weight: 600;
        margin-bottom: 20px;
        letter-spacing: 0.5px;
    }

    .scratch-content .sc-divider {
        width: 50px;
        height: 2px;
        background: linear-gradient(90deg, transparent, var(--gold), transparent);
        margin: 0 auto 14px;
    }

    .scratch-content .sc-prayer-label {
        font-size: 12px;
        color: var(--care-red);
        font-weight: 700;
        letter-spacing: 2px;
        margin-bottom: 8px;
    }

    .scratch-content .sc-prayer {
        font-size: 14px;
        color: var(--text-mid);
        line-height: 1.8;
        max-width: 300px;
    }

    .scratch-canvas {
        position: absolute;
        inset: 0;
        cursor: pointer;
        touch-action: none;
        z-index: 2;
    }

    .scratch-hint {
        position: absolute;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 3;
        color: white;
        font-size: 16px;
        font-weight: 700;
        letter-spacing: 3px;
        text-shadow: 0 2px 8px rgba(0,0,0,0.3);
        pointer-events: none;
        white-space: nowrap;
    }

    .scratch-hint.hidden { display: none; }

    @keyframes gentlePulse {
        0%, 100% { transform: translateX(-50%) scale(1); }
        50% { transform: translateX(-50%) scale(1.05); }
    }

    .scratch-hint { animation: gentlePulse 2s ease-in-out infinite; }

    .scratch-actions {
        display: flex;
        gap: 10px;
        justify-content: center;
        margin-top: 16px;
    }

    .scratch-actions .btn { font-size: 14px; padding: 10px 20px; border-radius: 24px; }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 400px) {
        .header h1 { font-size: 26px; }
        .header h1 .accent { font-size: 30px; }
        .day-item .title { font-size: 15px; }
        .detail-title { font-size: 24px; }
    }
</style>
```

</head>
<body>

<div class="toast" id="toast"></div>

<!-- ====== HEADER ====== -->

<div class="header">
    <h1><span class="accent">3C</span> é™ªä½ éå¹´ä¸ NG</h1>
    <p class="subtitle">è®“ã€3Cã€ä¸å†åªæœ‰å†·æ¼ ï¼Œè€Œæ˜¯å¸¶ä¾†æ„›çš„æº«åº¦</p>
</div>

<!-- ====== MAIN CONTAINER ====== -->

<div class="container">

```
<!-- Progress Card -->
<div class="progress-card">
    <div class="trophy">ğŸ†</div>
    <h3>è¿½è¹¤éˆä¿®é€²åº¦</h3>
    <p class="desc" id="progressDesc">è¼¸å…¥åå­—å³å¯è¨˜éŒ„æ¯æ—¥éˆä¿®æ‰“å¡ï¼Œè¿½è¹¤æ‚¨çš„é€²åº¦</p>

    <!-- Before login -->
    <div id="loginSection">
        <div class="name-input-row">
            <input type="text" id="nameInput" placeholder="è¼¸å…¥ä½ çš„åå­—" maxlength="20">
            <button class="btn btn-primary" onclick="login()">é–‹å§‹æ‰“å¡</button>
        </div>
    </div>

    <!-- After login -->
    <div id="loggedInSection" style="display:none">
        <div class="progress-bar-wrap">
            <div class="progress-bar-fill" id="progressBar" style="width:0%"></div>
        </div>
        <div class="progress-stats">
            <span><span class="count" id="checkedCount">0</span> / 28 å¤©å·²å®Œæˆ</span>
            <span id="percentText">0%</span>
        </div>
        <p class="user-greeting show" id="userGreeting">
            ğŸ‘‹ <span class="name" id="displayName"></span>ï¼Œé¡˜ä¸»è³œç¦ä½ ä»Šå¤©çš„éˆä¿®ï¼
            <button style="background:none;border:none;color:var(--text-light);font-size:12px;cursor:pointer;margin-left:4px" onclick="logout()">ç™»å‡º</button>
        </p>
    </div>
</div>

<!-- Scratch Card Section -->
<div class="scratch-section" id="scratchSection">
    <div class="scratch-section-title">âœ¨ ä»Šæ—¥ç¥ç¦åˆ®åˆ®åŒ…</div>
    <div class="scratch-section-desc">åˆ®é–‹é‡‘è‰²è¦†è“‹å±¤ï¼Œé ˜å—ä»Šå¤©çš„ç¥ç¦</div>
    <div class="scratch-card" id="scratchCard">
        <div class="scratch-content" id="scratchContent">
            <span class="sc-emoji" id="scEmoji">ğŸ“–</span>
            <p class="sc-verse" id="scVerse"></p>
            <p class="sc-ref" id="scRef"></p>
            <div class="sc-divider"></div>
            <p class="sc-prayer-label">ğŸ™ ç¦± å‘Š</p>
            <p class="sc-prayer" id="scPrayer"></p>
        </div>
        <canvas class="scratch-canvas" id="scratchCanvas"></canvas>
        <div class="scratch-hint" id="scratchHint">ğŸ‘† ç”¨æ‰‹æŒ‡åˆ®é–‹</div>
    </div>
    <div class="scratch-actions" id="scratchActions" style="display:none">
        <button class="btn btn-outline" onclick="scratchAgain()">ğŸ å†åˆ®ä¸€æ¬¡</button>
        <button class="btn btn-outline" onclick="shareScratch()">ğŸ“¤ åˆ†äº«ç¥ç¦</button>
    </div>
</div>

<!-- Legend -->
<div class="legend">
    <div class="legend-item"><div class="legend-dot connect"></div><span>Connect é€£çµ</span></div>
    <div class="legend-item"><div class="legend-dot care"></div><span>Care é—œå¿ƒ</span></div>
    <div class="legend-item"><div class="legend-dot calm"></div><span>Calm å®‰éœ</span></div>
</div>

<!-- Action Buttons -->
<div class="action-buttons">
    <button class="btn btn-google" onclick="addGoogleCal()">ğŸ“… åŠ å…¥ Google æ—¥æ›†</button>
    <button class="btn btn-iphone" onclick="addIphoneCal()">ğŸ“± åŠ å…¥ iPhone è¡Œäº‹æ›†</button>
</div>

<!-- Calendar Grid (Desktop) -->
<div class="calendar-grid" id="calendarGrid"></div>

<!-- Day List Title (Mobile) -->
<div class="day-list-title">ğŸ“… 2026 å¹´ 2 æœˆ éˆä¿®æœˆæ›†</div>

<!-- Day List -->
<div class="day-list" id="dayList"></div>

<!-- Footer -->
<div class="footer">
    Â©å°åŒ—çœŸç†å ‚ç‰ˆæ¬Š Taipei Truth Lutheran Church æ‰€æœ‰ã€‚
</div>
```

</div>

<!-- ====== DAY DETAIL OVERLAY ====== -->

<div class="detail-overlay" id="detailOverlay">
    <div class="detail-header">
        <button class="detail-back" onclick="closeDetail()">â†</button>
        <div class="detail-header-title" id="detailHeaderTitle"></div>
    </div>
    <div class="detail-body" id="detailBody"></div>
</div>

<script>
// ============================================================
//  DATA: 28 Days of February 2026
// ============================================================
const WEEKDAYS = ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'];

const DAYS_DATA = [
    {
        day: 1, weekday: 'æ—¥', lunar: '', title: 'é å‚™çš„å¿ƒ',
        categories: ['calm'],
        quiet: 'åœ¨æ–°æœˆä»½çš„é–‹å§‹ï¼Œè®“æˆ‘å€‘å®‰éœä¸‹ä¾†ï¼Œé å‚™ä¸€é¡†æŸ”è»Ÿçš„å¿ƒã€‚èŠ±äº”åˆ†é˜æ·±å‘¼å¸ï¼Œæ„Ÿå—ç¥çš„åŒåœ¨ã€‚æ”¾ä¸‹æ‰‹æ©Ÿã€æ”¾ä¸‹å¿™ç¢Œï¼Œè®“è‡ªå·±çœŸæ­£åœ°å®‰éœåœ¨ä¸»é¢å‰ã€‚',
        verse: 'ã€Œä½ å€‘è¦ä¼‘æ¯ï¼Œè¦çŸ¥é“æˆ‘æ˜¯ç¥ï¼ã€',
        verseRef: 'è©©ç¯‡ 46:10',
        prayer: 'è¦ªæ„›çš„å¤©çˆ¶ï¼Œåœ¨æ–°çš„ä¸€å€‹æœˆé–‹å§‹ï¼Œæ±‚ç¥¢é å‚™æˆ‘çš„å¿ƒã€‚è®“æˆ‘åœ¨å¿™ç¢Œä¸­å­¸æœƒå®‰éœï¼Œåœ¨å˜ˆé›œä¸­è½è¦‹ç¥¢çš„è²éŸ³ã€‚å¥‰ä¸»è€¶ç©Œçš„åç¦±å‘Šï¼Œé˜¿å€‘ã€‚'
    },
    {
        day: 2, weekday: 'ä¸€', lunar: '', title: 'æ”¾ä¸‹é‡æ“”',
        categories: ['calm'],
        quiet: 'æˆ‘å€‘æ¯å€‹äººå¿ƒä¸­éƒ½èƒŒè² è‘—ä¸åŒçš„é‡æ“”â€”â€”å·¥ä½œå£“åŠ›ã€äººéš›é—œä¿‚ã€å°æœªä¾†çš„ç„¦æ…®ã€‚ä»Šå¤©ï¼Œç·´ç¿’æŠŠé€™äº›é‡æ“”ä¸€ä¸€äº¤çµ¦ç¥ã€‚å¯«ä¸‹ä¸‰ä»¶è®“ä½ æ„Ÿåˆ°æ²‰é‡çš„äº‹ï¼Œç„¶å¾Œåœ¨ç¦±å‘Šä¸­äº¤è¨—ã€‚',
        verse: 'ã€Œå‡¡å‹è‹¦æ“”é‡æ“”çš„äººï¼Œå¯ä»¥åˆ°æˆ‘é€™è£¡ä¾†ï¼Œæˆ‘å°±ä½¿ä½ å€‘å¾—å®‰æ¯ã€‚ã€',
        verseRef: 'é¦¬å¤ªç¦éŸ³ 11:28',
        prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢é‚€è«‹æˆ‘åˆ°ç¥¢é¢å‰ã€‚æˆ‘æŠŠå¿ƒä¸­çš„é‡æ“”äº¤çµ¦ç¥¢ï¼Œæ±‚ç¥¢ç”¨ç¥¢çš„å¹³å®‰å–ä»£æˆ‘çš„ç„¦æ…®ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 3, weekday: 'äºŒ', lunar: '', title: 'æ„Ÿæ©çš„å¿ƒ',
        categories: ['calm'],
        quiet: 'æ„Ÿæ©èƒ½æ”¹è®Šæˆ‘å€‘çœ‹å¾…ç”Ÿæ´»çš„çœ¼å…‰ã€‚ä»Šå¤©ï¼Œå¯«ä¸‹äº”ä»¶ä½ æ„Ÿæ©çš„äº‹ã€‚å®ƒå€‘å¯ä»¥å¾ˆå°â€”â€”ä¸€æ¯ç†±èŒ¶ã€ä¸€å€‹å¾®ç¬‘ã€ä¸€æ¬¡å¹³å®‰åˆ°å®¶ã€‚è®“æ„Ÿæ©æˆç‚ºä½ é¢å°éå¹´çš„åŸºèª¿ã€‚',
        verse: 'ã€Œå‡¡äº‹è¬æ©ï¼Œå› ç‚ºé€™æ˜¯ç¥åœ¨åŸºç£è€¶ç©Œè£¡å‘ä½ å€‘æ‰€å®šçš„æ—¨æ„ã€‚ã€',
        verseRef: 'å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸ 5:18',
        prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢è³œçµ¦æˆ‘çš„ä¸€åˆ‡ã€‚æ±‚ç¥¢çµ¦æˆ‘ä¸€é›™çœ‹è¦‹æ©å…¸çš„çœ¼ç›ï¼Œåœ¨æ¯å¤©çš„æ—¥å¸¸ä¸­ç™¼ç¾ç¥¢çš„ç¾å¥½ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 4, weekday: 'ä¸‰', lunar: '', title: 'é¥’æ•çš„åŠ›é‡',
        categories: ['calm'],
        quiet: 'éå¹´å…ä¸äº†è¦‹åˆ°è¨±å¤šè¦ªå‹ï¼Œä¹Ÿå¯èƒ½è§¸ç¢°åˆ°éå»çš„å‚·ç—›ã€‚é¥’æ•ä¸æ˜¯å¦èªå‚·å®³ï¼Œè€Œæ˜¯é¸æ“‡ä¸è®“å‚·å®³ç¹¼çºŒç¶‘ç¶è‡ªå·±ã€‚ä»Šå¤©ï¼Œæ±‚ç¥çµ¦ä½ åŠ›é‡ï¼Œé–‹å§‹ä¸€æ®µé¥’æ•çš„æ—…ç¨‹ã€‚',
        verse: 'ã€Œä½ å€‘é¥’æ•äººçš„éçŠ¯ï¼Œä½ å€‘çš„å¤©çˆ¶ä¹Ÿå¿…é¥’æ•ä½ å€‘çš„éçŠ¯ã€‚ã€',
        verseRef: 'é¦¬å¤ªç¦éŸ³ 6:14',
        prayer: 'ä¸»å•Šï¼Œé¥’æ•å°æˆ‘ä¾†èªªå¾ˆé›£ã€‚ä½†æˆ‘é¡˜æ„å€šé ç¥¢çš„åŠ›é‡ï¼Œé¸æ“‡æ”¾ä¸‹ã€‚æ±‚ç¥¢é†«æ²»æˆ‘å¿ƒä¸­çš„å‚·å£ï¼Œè®“æˆ‘åœ¨æ„›ä¸­å¾—è‡ªç”±ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 5, weekday: 'å››', lunar: '', title: 'ç›¼æœ›çš„çœ¼å…‰',
        categories: ['calm'],
        quiet: 'ç•¶æˆ‘å€‘ç”¨ç›¼æœ›çš„çœ¼å…‰çœ‹å¾…ç”Ÿæ´»ï¼Œå›°é›£å°±ä¸å†æ˜¯çµ‚é»ï¼Œè€Œæ˜¯æˆé•·çš„å¥‘æ©Ÿã€‚æƒ³åƒä¸€ä¸‹ï¼Œä»Šå¹´éå¹´ä½ å¸Œæœ›æœ‰ä»€éº¼ä¸åŒï¼Ÿå¸¶è‘—ç›¼æœ›å»æœŸå¾…ã€‚',
        verse: 'ã€Œæˆ‘çŸ¥é“æˆ‘å‘ä½ å€‘æ‰€æ‡·çš„æ„å¿µæ˜¯è³œå¹³å®‰çš„æ„å¿µï¼Œä¸æ˜¯é™ç½ç¦çš„æ„å¿µï¼Œè¦å«ä½ å€‘æœ«å¾Œæœ‰æŒ‡æœ›ã€‚ã€',
        verseRef: 'è€¶åˆ©ç±³æ›¸ 29:11',
        prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢å°æˆ‘çš„ç¾å¥½è¨ˆåŠƒã€‚å³ä½¿æˆ‘çœ‹ä¸è¦‹å‰æ–¹çš„è·¯ï¼Œä½†æˆ‘ç›¸ä¿¡ç¥¢çš„å¸¶é ˜ã€‚æ±‚ç¥¢è³œæˆ‘ç›¼æœ›çš„çœ¼å…‰ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 6, weekday: 'äº”', lunar: '', title: 'æ„›çš„æºé ­',
        categories: ['calm'],
        quiet: 'çœŸæ­£çš„æ„›ä¸æ˜¯å‡ºæ–¼æˆ‘å€‘è‡ªå·±ï¼Œè€Œæ˜¯æºè‡ªæ–¼ç¥ã€‚åœ¨éå¹´æœŸé–“ï¼Œæˆ‘å€‘éœ€è¦å¾ˆå¤šçš„æ„›â€”â€”æ„›å®¶äººã€æ„›è‡ªå·±ã€ä¹Ÿæ„›é‚£äº›ä¸å¤ªå®¹æ˜“æ„›çš„äººã€‚è®“æˆ‘å€‘å…ˆå›åˆ°æ„›çš„æºé ­ã€‚',
        verse: 'ã€Œæˆ‘å€‘æ„›ï¼Œå› ç‚ºç¥å…ˆæ„›æˆ‘å€‘ã€‚ã€',
        verseRef: 'ç´„ç¿°ä¸€æ›¸ 4:19',
        prayer: 'ä¸»å•Šï¼Œç¥¢å°±æ˜¯æ„›çš„æºé ­ã€‚æ±‚ç¥¢è®“ç¥¢çš„æ„›å……æ»¿æˆ‘ï¼Œä½¿æˆ‘åœ¨éå¹´æœŸé–“èƒ½ç”¨ç¥¢çš„æ„›å»æ„›èº«é‚Šçš„äººã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 7, weekday: 'å…­', lunar: '', title: 'ä¿¡å¿ƒçš„è…³æ­¥',
        categories: ['calm'],
        quiet: 'ç¬¬ä¸€é€±å³å°‡çµæŸï¼Œé¡˜ä½ é€™é€±æœ‰æ›´å¤šå®‰éœçš„æ™‚é–“èˆ‡ç¥è¦ªè¿‘ã€‚ä¿¡å¿ƒä¸æ˜¯çœ‹è¦‹æ‰ç›¸ä¿¡ï¼Œæ˜¯åœ¨çœ‹ä¸è¦‹çš„æ™‚å€™ä¾ç„¶å‰è¡Œã€‚å¸¶è‘—ç¬¬ä¸€é€±ç´¯ç©çš„ä¿¡å¿ƒï¼Œé å‚™è¿æ¥æ¥ä¸‹ä¾†çš„æ—¥å­ã€‚',
        verse: 'ã€Œä¿¡å°±æ˜¯æ‰€æœ›ä¹‹äº‹çš„å¯¦åº•ï¼Œæ˜¯æœªè¦‹ä¹‹äº‹çš„ç¢ºæ“šã€‚ã€',
        verseRef: 'å¸Œä¼¯ä¾†æ›¸ 11:1',
        prayer: 'å¤©çˆ¶ï¼Œå³ä½¿å‰è·¯æœªæ˜ï¼Œæˆ‘é¸æ“‡ä¿¡é ç¥¢ã€‚æ±‚ç¥¢å …å›ºæˆ‘çš„ä¿¡å¿ƒï¼Œè®“æˆ‘æ¯ä¸€æ­¥éƒ½è¸åœ¨ç¥¢çš„æ‡‰è¨±ä¸Šã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 8, weekday: 'æ—¥', lunar: '', title: 'é å‚™å¥½äº†',
        categories: ['calm'],
        quiet: 'è·é›¢éå¹´åªå‰©ä¸€é€±ï¼Œä½ æº–å‚™å¥½äº†å—ï¼Ÿä¸åªæ˜¯å¹´è²¨å’Œæ‰“æƒï¼Œæ›´é‡è¦çš„æ˜¯å¿ƒéˆçš„æº–å‚™ã€‚ä»Šå¤©ï¼ŒèŠ±æ™‚é–“æ•´ç†è‡ªå·±çš„å…§å¿ƒï¼ŒæŠŠä¸å¹³å®‰çš„äº‹äº¤çµ¦ç¥ã€‚',
        verse: 'ã€Œæ‰€ä»¥ï¼Œä¸è¦ç‚ºæ˜å¤©æ†‚æ…®ï¼Œå› ç‚ºæ˜å¤©è‡ªæœ‰æ˜å¤©çš„æ†‚æ…®ï¼›ä¸€å¤©çš„é›£è™•ä¸€å¤©ç•¶å°±å¤ äº†ã€‚ã€',
        verseRef: 'é¦¬å¤ªç¦éŸ³ 6:34',
        prayer: 'ä¸»è€¶ç©Œï¼Œæ±‚ç¥¢å¹«åŠ©æˆ‘ä¸è¦ç‚ºéå¹´çš„æº–å‚™ç„¦æ…®ã€‚è®“æˆ‘æŠŠçœ¼å…‰æ”¾åœ¨ç¥¢èº«ä¸Šï¼Œä¸€æ­¥ä¸€æ­¥ä¾†ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 9, weekday: 'ä¸€', lunar: '', title: 'å»ºç«‹ç•Œç·š',
        categories: ['calm'],
        quiet: 'éå¹´æ™‚ï¼Œã€Œç•Œç·šã€æ˜¯ä¿è­·è‡ªå·±çš„é‡è¦å·¥å…·ã€‚é¢å°éåº¦çš„è©¢å•æˆ–å£“åŠ›ï¼Œä½ å¯ä»¥æº«æŸ”è€Œå …å®šåœ°è¨­ç«‹ç•Œç·šã€‚è¨˜ä½ï¼šèªªã€Œä¸ã€ä¸ä»£è¡¨ä¸æ„›å°æ–¹ã€‚',
        verse: 'ã€Œä½ è¦ä¿å®ˆä½ å¿ƒï¼Œå‹éä¿å®ˆä¸€åˆ‡ï¼Œå› ç‚ºä¸€ç”Ÿçš„æœæ•ˆï¼Œæ˜¯ç”±å¿ƒç™¼å‡ºã€‚ã€',
        verseRef: 'ç®´è¨€ 4:23',
        prayer: 'å¤©çˆ¶ï¼Œæ±‚ç¥¢çµ¦æˆ‘æ™ºæ…§ï¼ŒçŸ¥é“ä½•æ™‚è©²èªªå¥½ã€ä½•æ™‚è©²èªªä¸ã€‚è®“æˆ‘åœ¨ä¿è­·è‡ªå·±çš„åŒæ™‚ï¼Œä¹Ÿä¸å¤±å»æ„›äººçš„å¿ƒã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 10, weekday: 'äºŒ', lunar: '', title: 'çœŸå¯¦çš„æ„›',
        categories: ['calm'],
        quiet: 'çœŸå¯¦çš„æ„›æ˜¯çœŸèª çš„ã€ä¸è™›å‡çš„ã€‚éå¹´æœŸé–“ï¼Œè®“æˆ‘å€‘å°‘ä¸€äº›å®¢å¥—ã€å¤šä¸€äº›çœŸå¿ƒã€‚æƒ³æƒ³æœ‰æ²’æœ‰ä¸€å€‹äººï¼Œä½ å¯ä»¥ä»Šå¤©å°ä»–èªªä¸€å¥çœŸå¿ƒè©±ï¼Ÿ',
        verse: 'ã€Œæ„›äººä¸å¯è™›å‡ï¼Œæƒ¡è¦å­æƒ¡ï¼Œå–„è¦è¦ªè¿‘ã€‚ã€',
        verseRef: 'ç¾…é¦¬æ›¸ 12:9',
        prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢å¹«åŠ©æˆ‘æ´»å‡ºçœŸå¯¦çš„æ„›ã€‚è®“æˆ‘ä¸æ˜¯ç‚ºäº†æ‡‰ä»˜è€Œæ„›ï¼Œè€Œæ˜¯å¾å¿ƒåº•çœŸèª åœ°é—œå¿ƒèº«é‚Šçš„äººã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 11, weekday: 'ä¸‰', lunar: '', title: 'èª å¯¦æºé€š',
        categories: ['calm'],
        quiet: 'å¾ˆå¤šå®¶åº­è¡çªä¾†è‡ªæ–¼æºé€šä¸è‰¯ã€‚ä»Šå¤©ç·´ç¿’ã€Œæˆ‘è¨Šæ¯ã€ï¼šä¸æ˜¯èªªã€Œä½ ç¸½æ˜¯â€¦ã€ï¼Œè€Œæ˜¯èªªã€Œæˆ‘æ„Ÿè¦ºâ€¦ã€ã€‚ç”¨æº«æŸ”è€Œèª å¯¦çš„æ–¹å¼è¡¨é”è‡ªå·±ã€‚',
        verse: 'ã€Œèªªè©±æµ®èºçš„ï¼Œå¦‚åˆ€åˆºäººï¼›æ™ºæ…§äººçš„èˆŒé ­ï¼Œå»ç‚ºé†«äººçš„è‰¯è—¥ã€‚ã€',
        verseRef: 'ç®´è¨€ 12:18',
        prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢ç®¡ç†æˆ‘çš„å£èˆŒã€‚è®“æˆ‘èªªçš„æ¯å¥è©±éƒ½å¸¶è‘—æ©å…¸å’Œæ™ºæ…§ï¼Œæˆç‚ºé†«æ²»è€Œä¸æ˜¯å‚·å®³ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 12, weekday: 'å››', lunar: '', title: 'æ¥ç´ä¸å®Œç¾',
        categories: ['calm'],
        quiet: 'å®¶äººä¸å®Œç¾ã€è‡ªå·±ä¹Ÿä¸å®Œç¾â€”â€”è€Œé€™å°±æ˜¯æˆ‘å€‘éœ€è¦æ©å…¸çš„åŸå› ã€‚ä»Šå¤©ï¼Œç·´ç¿’æ¥ç´ï¼šæ¥ç´å®¶äººçš„ä¸å®Œç¾ï¼Œä¹Ÿæ¥ç´è‡ªå·±çš„ä¸å®Œç¾ã€‚',
        verse: 'ã€Œæˆ‘çš„æ©å…¸å¤ ä½ ç”¨çš„ï¼Œå› ç‚ºæˆ‘çš„èƒ½åŠ›æ˜¯åœ¨äººçš„è»Ÿå¼±ä¸Šé¡¯å¾—å®Œå…¨ã€‚ã€',
        verseRef: 'å“¥æ—å¤šå¾Œæ›¸ 12:9',
        prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢æ¥ç´ä¸å®Œç¾çš„æˆ‘ã€‚æ±‚ç¥¢å¹«åŠ©æˆ‘ä¹Ÿç”¨æ©å…¸çš„çœ¼å…‰çœ‹å¾…å®¶äººï¼Œåœ¨ä¸å®Œç¾ä¸­çœ‹è¦‹ç¥¢çš„å®Œç¾ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 13, weekday: 'äº”', lunar: '', title: 'ç¨è™•çš„åŠ›é‡',
        categories: ['calm'],
        quiet: 'éå¹´æœŸé–“äººå¤šå˜ˆé›œï¼Œä½†åˆ¥å¿˜äº†çµ¦è‡ªå·±ç¨è™•çš„ç©ºé–“ã€‚å³ä½¿åªæœ‰ååˆ†é˜ï¼Œæ‰¾å€‹å®‰éœçš„è§’è½ï¼Œæ·±å‘¼å¸ï¼Œèˆ‡ç¥å°è©±ã€‚ç¨è™•ä¸æ˜¯å­¤å–®ï¼Œæ˜¯å……é›»ã€‚',
        verse: 'ã€Œä½†è€¶ç©Œå»é€€åˆ°æ› é‡å»ç¦±å‘Šã€‚ã€',
        verseRef: 'è·¯åŠ ç¦éŸ³ 5:16',
        prayer: 'ä¸»è€¶ç©Œï¼Œç¥¢ä¹Ÿéœ€è¦ç¨è™•çš„æ™‚é–“ã€‚æ±‚ç¥¢å¹«åŠ©æˆ‘åœ¨éå¹´çš„ç†±é¬§ä¸­ï¼Œæ‰¾åˆ°èˆ‡ç¥¢å®‰éœç›¸è™•çš„æ™‚åˆ»ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 14, weekday: 'å…­', lunar: '', title: 'æ„›çš„ç•Œç·š',
        categories: ['calm'],
        quiet: 'æ˜å¤©å°±æ˜¯å°å¹´å¤œäº†ï¼å¸¶è‘—é€™å…©é€±ç´¯ç©çš„é å‚™ï¼Œä½ å·²ç¶“æ¯”ä¹‹å‰æ›´æœ‰è£å‚™äº†ã€‚è¨˜ä½ï¼šå¸¶è‘—æ„›å»è¨­ç«‹ç•Œç·šï¼Œå¸¶è‘—æ©å…¸å»é¢å°é—œä¿‚ã€‚',
        verse: 'ã€Œæœ€è¦ç·Šçš„æ˜¯å½¼æ­¤åˆ‡å¯¦ç›¸æ„›ï¼Œå› ç‚ºæ„›èƒ½é®æ©è¨±å¤šçš„ç½ªã€‚ã€',
        verseRef: 'å½¼å¾—å‰æ›¸ 4:8',
        prayer: 'å¤©çˆ¶ï¼Œæ˜å¤©å°±è¦é–‹å§‹éå¹´äº†ã€‚æ±‚ç¥¢ç”¨ç¥¢çš„æ„›è¦†è“‹æˆ‘çš„å®¶åº­ï¼Œè®“é€™å€‹å¹´æˆç‚ºå……æ»¿æ©å…¸çš„æ™‚å…‰ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 15, weekday: 'æ—¥', lunar: 'å°å¹´å¤œ', title: 'Coming Home!',
        categories: ['connect', 'care', 'calm'],
        quiet: 'å°å¹´å¤œäº†ï¼ä¸ç®¡ä½ æ˜¯åœ¨å›å®¶çš„è·¯ä¸Šï¼Œé‚„æ˜¯å·²ç¶“åˆ°å®¶ï¼ŒèŠ±ä¸€é»æ™‚é–“å®‰éœè‡ªå·±çš„å¿ƒã€‚æ·±å‘¼å¸ä¸‰æ¬¡ï¼Œè®“å›å®¶çš„æ„Ÿè¦ºæº«æš–ä½ ã€‚',
        verse: 'ã€Œçœ‹å“ªï¼Œæˆ‘ç«™åœ¨é–€å¤–å©é–€ï¼Œè‹¥æœ‰è½è¦‹æˆ‘è²éŸ³å°±é–‹é–€çš„ï¼Œæˆ‘è¦é€²åˆ°ä»–é‚£è£¡å»ï¼Œæˆ‘èˆ‡ä»–ï¼Œä»–èˆ‡æˆ‘ï¼Œä¸€åŒåå¸­ã€‚ã€',
        verseRef: 'å•Ÿç¤ºéŒ„ 3:20',
        prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢å¸¶æˆ‘å›å®¶ã€‚ä¸åªæ˜¯å›åˆ°åœ°ä¸Šçš„å®¶ï¼Œæ›´æ˜¯å›åˆ°ç¥¢çš„æ„›è£¡ã€‚æ±‚ç¥¢èˆ‡æˆ‘å€‘çš„å®¶åŒåœ¨ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 16, weekday: 'ä¸€', lunar: 'é™¤å¤•', title: 'é™¤èˆŠä½ˆæ–°ï¼',
        categories: ['connect', 'care', 'calm'],
        quiet: 'é™¤å¤•å¤œï¼Œä¸åªæ˜¯å¤–åœ¨çš„é™¤èˆŠä½ˆæ–°ï¼Œä¹Ÿæ˜¯å…§å¿ƒçš„æ›´æ–°ã€‚ä»Šå¤©ï¼Œæ”¾ä¸‹å»å¹´çš„éºæ†¾å’Œå‚·ç—›ï¼Œå¸¶è‘—ç›¼æœ›è¿æ¥æ–°çš„ä¸€å¹´ã€‚',
        verse: 'ã€Œè‹¥æœ‰äººåœ¨åŸºç£è£¡ï¼Œä»–å°±æ˜¯æ–°é€ çš„äººï¼ŒèˆŠäº‹å·²éï¼Œéƒ½è®Šæˆæ–°çš„äº†ã€‚ã€',
        verseRef: 'å“¥æ—å¤šå¾Œæ›¸ 5:17',
        prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢è®“æˆ‘å€‘åœ¨åŸºç£è£¡æˆç‚ºæ–°é€ çš„äººã€‚åœ¨é€™å€‹é™¤å¤•å¤œï¼Œæ±‚ç¥¢æ›´æ–°æˆ‘å€‘å…¨å®¶ï¼Œé™¤å»èˆŠæœ‰çš„é‡æ“”ï¼Œè¿æ¥æ–°çš„æ©å…¸ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 17, weekday: 'äºŒ', lunar: 'åˆä¸€', title: 'æ–°çš„ä¸€å¹´å¾Cé–‹å§‹',
        categories: ['connect', 'care', 'calm'],
        quiet: 'æ–°å¹´ç¬¬ä¸€å¤©ï¼ä»Šå¹´çš„ 3C å¾ä»Šå¤©é–‹å§‹â€”â€”Connect èˆ‡ç¥é€£çµã€Care å½¼æ­¤é—œå¿ƒã€Calm å…§å¿ƒå®‰éœã€‚é¸ä¸€å€‹å­—ä½œç‚ºä½ ä»Šå¹´çš„åº§å³éŠ˜ã€‚',
        verse: 'ã€Œé€™æ˜¯è€¶å’Œè¯æ‰€å®šçš„æ—¥å­ï¼Œæˆ‘å€‘åœ¨å…¶ä¸­è¦é«˜èˆˆæ­¡å–œï¼ã€',
        verseRef: 'è©©ç¯‡ 118:24',
        prayer: 'ä¸»å•Šï¼Œæ–°å¹´æ–°æ°£è±¡ï¼æ„Ÿè¬ç¥¢è³œä¸‹æ–°çš„ä¸€å¹´ï¼Œæ±‚ç¥¢å¹«åŠ©æˆ‘åœ¨æ¯ä¸€å¤©éƒ½æ´»å‡º Connectã€Careã€Calm çš„ç”Ÿæ´»ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 18, weekday: 'ä¸‰', lunar: 'åˆäºŒ', title: 'è¦ªæˆšè¦‹é¢ç¬‘CC',
        categories: ['connect', 'care', 'calm'],
        quiet: 'åˆäºŒå›å¨˜å®¶ï¼ˆæˆ–è¦‹è¦ªæˆšï¼‰çš„æ—¥å­ã€‚é¢å°å„ç¨®å•å€™å’Œé—œå¿ƒï¼Œå¸¶è‘—å¾®ç¬‘å’Œæ©å…¸å›æ‡‰ã€‚è¨˜ä½ä½ é å‚™å¥½çš„ç•Œç·šï¼Œä¹Ÿè¨˜ä½æ„›ã€‚',
        verse: 'ã€Œå›ç­”æŸ”å’Œï¼Œä½¿æ€’æ¶ˆé€€ï¼›è¨€èªæš´æˆ¾ï¼Œè§¸å‹•æ€’æ°£ã€‚ã€',
        verseRef: 'ç®´è¨€ 15:1',
        prayer: 'ä¸»è€¶ç©Œï¼Œé¢å°è¦ªæˆšçš„å„ç¨®å•å€™ï¼Œæ±‚ç¥¢çµ¦æˆ‘æ™ºæ…§å’Œå¹½é»˜æ„Ÿã€‚è®“æˆ‘ç”¨æŸ”å’Œçš„å›ç­”åŒ–è§£å°·å°¬ï¼Œç”¨æ„›é€£çµå®¶äººã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 19, weekday: 'å››', lunar: 'åˆä¸‰', title: 'ä¼¼ä¹ç´¯ç´¯çš„',
        categories: ['connect', 'care', 'calm'],
        quiet: 'éå¹´åˆ°ç¬¬ä¸‰å¤©ï¼Œå¯èƒ½å·²ç¶“æœ‰é»ç–²ç´¯äº†ã€‚æ²’é—œä¿‚ï¼Œç´¯äº†å°±ä¼‘æ¯ã€‚ä¸éœ€è¦å‹‰å¼·è‡ªå·±ä¸€ç›´ç¤¾äº¤ï¼Œçµ¦è‡ªå·±ä¸€äº›å–˜æ¯çš„ç©ºé–“ã€‚',
        verse: 'ã€Œä»–ä½¿æˆ‘èººè‡¥åœ¨é’è‰åœ°ä¸Šï¼Œé ˜æˆ‘åœ¨å¯å®‰æ­‡çš„æ°´é‚Šã€‚ä»–ä½¿æˆ‘çš„éˆé­‚ç”¦é†’ã€‚ã€',
        verseRef: 'è©©ç¯‡ 23:2-3',
        prayer: 'ä¸»å•Šï¼Œæˆ‘æœ‰é»ç´¯äº†ã€‚æ±‚ç¥¢åšæˆ‘çš„ç‰§è€…ï¼Œå¸¶æˆ‘åˆ°å¯å®‰æ­‡çš„åœ°æ–¹ã€‚åœ¨ä¼‘æ¯ä¸­æ¢å¾©æˆ‘çš„åŠ›é‡å’Œå–œæ¨‚ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 20, weekday: 'äº”', lunar: 'åˆå››', title: 'æ”¶å¿ƒä¸ç”¨ä¸€ä¸‹å­å®Œæˆ',
        categories: ['connect', 'care', 'calm'],
        quiet: 'æ…¢æ…¢æ”¶å¿ƒå°±å¥½ï¼Œä¸éœ€è¦ä¸€ä¸‹å­å¾éå¹´æ¨¡å¼åˆ‡æ›åˆ°å·¥ä½œæ¨¡å¼ã€‚çµ¦è‡ªå·±ä¸€äº›ç·©è¡çš„æ™‚é–“ï¼Œåƒæ˜¯æ…¢æ…¢èª¿ç¯€æ°´æº«ä¸€æ¨£ã€‚',
        verse: 'ã€Œä½†é‚£ç­‰å€™è€¶å’Œè¯çš„å¿…é‡æ–°å¾—åŠ›ã€‚ä»–å€‘å¿…å¦‚é·¹å±•ç¿…ä¸Šé¨°ï¼›ä»–å€‘å¥”è·‘å»ä¸å›°å€¦ï¼Œè¡Œèµ°å»ä¸ç–²ä¹ã€‚ã€',
        verseRef: 'ä»¥è³½äºæ›¸ 40:31',
        prayer: 'å¤©çˆ¶ï¼Œæ±‚ç¥¢å¹«åŠ©æˆ‘åœ¨æ”¶å‡çš„éç¨‹ä¸­ä¸ç„¦æ€¥ã€‚è®“æˆ‘åœ¨ç­‰å€™ä¸­é‡æ–°å¾—åŠ›ï¼Œé å‚™å¥½å¿ƒè¿æ¥æ–°çš„é–‹å§‹ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 21, weekday: 'å…­', lunar: 'åˆäº”', title: 'è€¶ç©Œæœƒé™ªä½ ï¼',
        categories: ['connect', 'care', 'calm'],
        quiet: 'éå¹´å‡æœŸæ¥è¿‘å°¾è²ã€‚ä¸ç®¡é€™å€‹å¹´éå¾—å¦‚ä½•â€”â€”é–‹å¿ƒçš„ã€è¾›è‹¦çš„ã€è¤‡é›œçš„â€”â€”è€¶ç©Œéƒ½åœ¨ã€‚ç¥‚ä¸åªé™ªä½ éå¹´ï¼Œä¹Ÿé™ªä½ éæ¯ä¸€å¤©ã€‚',
        verse: 'ã€Œæˆ‘ç¸½ä¸æ’‡ä¸‹ä½ ï¼Œä¹Ÿä¸ä¸Ÿæ£„ä½ ã€‚ã€',
        verseRef: 'å¸Œä¼¯ä¾†æ›¸ 13:5',
        prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢ä¸€ç›´éƒ½åœ¨ã€‚ä¸ç®¡éå¹´ç™¼ç”Ÿäº†ä»€éº¼ï¼Œç¥¢éƒ½é™ªè‘—æˆ‘èµ°éã€‚æ±‚ç¥¢ç¹¼çºŒå¸¶é ˜æˆ‘æ¥ä¸‹ä¾†çš„æ¯ä¸€å¤©ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 22, weekday: 'æ—¥', lunar: '', title: 'å›åˆ°æ—¥å¸¸',
        categories: ['calm'],
        quiet: 'å‡æœŸçµæŸäº†ï¼Œå›åˆ°æ—¥å¸¸ç”Ÿæ´»ã€‚å¸¶è‘—éå¹´æœŸé–“å­¸åˆ°çš„åŠŸèª²â€”â€”å®‰éœã€æ„Ÿæ©ã€ç•Œç·šã€é¥’æ•â€”â€”ç¹¼çºŒèµ°æ¯å¤©çš„è·¯ã€‚',
        verse: 'ã€Œä½ å€‘è¦å¸¸åœ¨æˆ‘è£¡é¢ï¼Œæˆ‘ä¹Ÿå¸¸åœ¨ä½ å€‘è£¡é¢ã€‚æå­è‹¥ä¸å¸¸åœ¨è‘¡è„æ¨¹ä¸Šï¼Œè‡ªå·±å°±ä¸èƒ½çµæœå­ï¼›ä½ å€‘è‹¥ä¸å¸¸åœ¨æˆ‘è£¡é¢ï¼Œä¹Ÿæ˜¯é€™æ¨£ã€‚ã€',
        verseRef: 'ç´„ç¿°ç¦éŸ³ 15:4',
        prayer: 'ä¸»å•Šï¼Œå›åˆ°æ—¥å¸¸äº†ã€‚æ±‚ç¥¢å¹«åŠ©æˆ‘ç¹¼çºŒä½åœ¨ç¥¢è£¡é¢ï¼Œåœ¨æ¯å¤©çš„å·¥ä½œå’Œç”Ÿæ´»ä¸­çµå‡ºå¥½æœå­ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 23, weekday: 'ä¸€', lunar: '', title: 'å‹‡æ•¢é¢å°',
        categories: ['calm'],
        quiet: 'ä¹Ÿè¨±éå¹´æœŸé–“ç•™ä¸‹äº†ä¸€äº›éœ€è¦è™•ç†çš„äº‹æƒ…â€”â€”ä¸€æ®µå°è©±ã€ä¸€å€‹æ±ºå®šã€ä¸€ä»½æ„Ÿå—ã€‚ä»Šå¤©ï¼Œå¸¶è‘—å‹‡æ°£å»é¢å°ã€‚ç¥èˆ‡ä½ åŒåœ¨ã€‚',
        verse: 'ã€Œæˆ‘è±ˆæ²’æœ‰å©å’ä½ å—ï¼Ÿä½ ç•¶å‰›å¼·å£¯è†½ï¼ä¸è¦æ‡¼æ€•ï¼Œä¹Ÿä¸è¦é©šæƒ¶ï¼›å› ç‚ºä½ ç„¡è«–å¾€å“ªè£¡å»ï¼Œè€¶å’Œè¯ä½ çš„ç¥å¿…èˆ‡ä½ åŒåœ¨ã€‚ã€',
        verseRef: 'ç´„æ›¸äºè¨˜ 1:9',
        prayer: 'å¤©çˆ¶ï¼Œæœ‰äº›äº‹æˆ‘ä¸€ç›´åœ¨é€ƒé¿ã€‚æ±‚ç¥¢è³œæˆ‘å‹‡æ°£å»é¢å°ï¼Œå› ç‚ºæˆ‘çŸ¥é“ç¥¢èˆ‡æˆ‘åŒåœ¨ï¼Œæˆ‘ä¸éœ€è¦å®³æ€•ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 24, weekday: 'äºŒ', lunar: '', title: 'æ™ºæ…§çš„å¿ƒ',
        categories: ['calm'],
        quiet: 'é¢å°ç”Ÿæ´»ä¸­çš„å„ç¨®é¸æ“‡å’ŒæŒ‘æˆ°ï¼Œæˆ‘å€‘éœ€è¦å¾ç¥è€Œä¾†çš„æ™ºæ…§ã€‚æ™ºæ…§ä¸åªæ˜¯è°æ˜ï¼Œæ›´æ˜¯çŸ¥é“ä»€éº¼æ˜¯å°çš„ã€ä»€éº¼æ˜¯å¥½çš„ã€ä»€éº¼æ˜¯ç¥å–œæ‚…çš„ã€‚',
        verse: 'ã€Œä½ å€‘ä¸­é–“è‹¥æœ‰ç¼ºå°‘æ™ºæ…§çš„ï¼Œæ‡‰ç•¶æ±‚é‚£åšè³œèˆ‡çœ¾äººã€ä¹Ÿä¸æ–¥è²¬äººçš„ç¥ï¼Œä¸»å°±å¿…è³œçµ¦ä»–ã€‚ã€',
        verseRef: 'é›…å„æ›¸ 1:5',
        prayer: 'ä¸»å•Šï¼Œæˆ‘éœ€è¦ç¥¢çš„æ™ºæ…§ã€‚æ±‚ç¥¢åœ¨æˆ‘æ¯å¤©çš„æ±ºå®šä¸­å¼•å°æˆ‘ï¼Œè®“æˆ‘è¡Œåœ¨ç¥¢çš„æ—¨æ„ä¸­ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 25, weekday: 'ä¸‰', lunar: '', title: 'å–œæ¨‚çš„å¿ƒ',
        categories: ['calm'],
        quiet: 'å–œæ¨‚ä¸æ˜¯å› ç‚ºç’°å¢ƒé †åˆ©ï¼Œè€Œæ˜¯å› ç‚ºçŸ¥é“ç¥æŒæ¬Šã€‚ä»Šå¤©ï¼Œå³ä½¿é¢å°å›°é›£ï¼Œä¹Ÿé¸æ“‡å–œæ¨‚ã€‚é€™ä¸æ˜¯å‡è£ï¼Œè€Œæ˜¯ä¿¡å¿ƒçš„æ“ç·´ã€‚',
        verse: 'ã€Œå–œæ¨‚çš„å¿ƒä¹ƒæ˜¯è‰¯è—¥ï¼›æ†‚å‚·çš„éˆä½¿éª¨æ¯ä¹¾ã€‚ã€',
        verseRef: 'ç®´è¨€ 17:22',
        prayer: 'å¤©çˆ¶ï¼Œæ±‚ç¥¢å°‡å–œæ¨‚çš„å¿ƒè³œçµ¦æˆ‘ã€‚è®“é€™ä»½å¾ç¥¢è€Œä¾†çš„å–œæ¨‚æˆç‚ºæˆ‘ç”Ÿå‘½çš„åŠ›é‡å’Œé†«æ²»ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 26, weekday: 'å››', lunar: '', title: 'è¬™å‘åŒè¡Œ',
        categories: ['calm'],
        quiet: 'è¬™å‘ä¸æ˜¯çœ‹è¼•è‡ªå·±ï¼Œè€Œæ˜¯ä¸éåº¦çœ‹é‡è‡ªå·±ã€‚åœ¨èˆ‡äººç›¸è™•ä¸­ï¼Œè¬™å‘è®“æˆ‘å€‘èƒ½è†è½ã€èƒ½å­¸ç¿’ã€èƒ½æˆé•·ã€‚',
        verse: 'ã€Œä¸–äººå“ªï¼Œè€¶å’Œè¯å·²æŒ‡ç¤ºä½ ä½•ç‚ºå–„ã€‚ä»–å‘ä½ æ‰€è¦çš„æ˜¯ä»€éº¼å‘¢ï¼Ÿåªè¦ä½ è¡Œå…¬ç¾©ï¼Œå¥½æ†æ†«ï¼Œå­˜è¬™å‘çš„å¿ƒï¼Œèˆ‡ä½ çš„ç¥åŒè¡Œã€‚ã€',
        verseRef: 'å½Œè¿¦æ›¸ 6:8',
        prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢çµ¦æˆ‘ä¸€é¡†è¬™å‘çš„å¿ƒã€‚è®“æˆ‘åœ¨èˆ‡äººåŒè¡Œä¸­ä¸é©•å‚²ï¼Œä¹Ÿè®“æˆ‘åœ¨èˆ‡ç¥¢åŒè¡Œä¸­æ›´åŠ è¦ªè¿‘ç¥¢ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 27, weekday: 'äº”', lunar: '', title: 'ä¸ä½ç¦±å‘Š',
        categories: ['calm'],
        quiet: 'ç¦±å‘Šä¸åªæ˜¯é–‰çœ¼é›™æ‰‹åˆåâ€”â€”å®ƒæ˜¯éš¨æ™‚éš¨åœ°èˆ‡ç¥å°è©±ã€‚åœ¨é€šå‹¤è·¯ä¸Šã€åœ¨å·¥ä½œé–“éš™ã€åœ¨ç¡å‰ç‰‡åˆ»ï¼Œéƒ½å¯ä»¥è·Ÿç¥èªªèªªè©±ã€‚',
        verse: 'ã€Œä¸ä½åœ°ç¦±å‘Šã€‚ã€',
        verseRef: 'å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸ 5:17',
        prayer: 'å¤©çˆ¶ï¼Œæ±‚ç¥¢å¹«åŠ©æˆ‘é¤Šæˆä¸ä½ç¦±å‘Šçš„ç¿’æ…£ã€‚ä¸åªæ˜¯åœ¨éˆä¿®æ™‚é–“ï¼Œè€Œæ˜¯åœ¨æ¯å€‹æ™‚åˆ»éƒ½èˆ‡ç¥¢åŒåœ¨ã€èˆ‡ç¥¢å°è©±ã€‚é˜¿å€‘ã€‚'
    },
    {
        day: 28, weekday: 'å…­', lunar: '', title: 'äºŒæœˆçš„å°¾è²',
        categories: ['calm'],
        quiet: 'äºŒæœˆå³å°‡çµæŸï¼Œä½†ä½ èˆ‡ç¥çš„æ—…ç¨‹ä¸æœƒçµæŸã€‚å›é¡§é€™å€‹æœˆï¼Œä½ ç¶“æ­·äº†é å‚™ã€éå¹´ã€æ”¶å¿ƒï¼Œæ¯ä¸€æ­¥éƒ½æœ‰ç¥çš„é™ªä¼´ã€‚å¸¶è‘—é€™ä»½ä¿¡å¿ƒï¼Œç¹¼çºŒå‘å‰èµ°ï¼',
        verse: 'ã€Œé‚£ç¾å¥½çš„ä»—æˆ‘å·²ç¶“æ‰“éäº†ï¼Œç•¶è·‘çš„è·¯æˆ‘å·²ç¶“è·‘ç›¡äº†ï¼Œæ‰€ä¿¡çš„é“æˆ‘å·²ç¶“å®ˆä½äº†ã€‚ã€',
        verseRef: 'ææ‘©å¤ªå¾Œæ›¸ 4:7',
        prayer: 'ä¸»å•Šï¼Œæ„Ÿè¬ç¥¢é€™å€‹æœˆçš„å¸¶é ˜ã€‚é›–ç„¶äºŒæœˆçµæŸäº†ï¼Œä½†æˆ‘èˆ‡ç¥¢çš„é—œä¿‚æ‰å‰›é–‹å§‹æ›´æ·±ã€‚æ±‚ç¥¢ç¹¼çºŒå¸¶é ˜æˆ‘ï¼Œç›´åˆ°æ°¸é ã€‚é˜¿å€‘ã€‚'
    }
];

// ============================================================
//  LocalStorage
// ============================================================
function getUser() { return localStorage.getItem('3c_user') || ''; }
function setUser(n) { localStorage.setItem('3c_user', n); }
function removeUser() { localStorage.removeItem('3c_user'); }

function getChecked() {
    try { return JSON.parse(localStorage.getItem('3c_checked') || '{}'); } 
    catch { return {}; }
}
function setChecked(day) {
    const c = getChecked();
    c[day] = new Date().toISOString();
    localStorage.setItem('3c_checked', JSON.stringify(c));
}
function isChecked(day) { return !!getChecked()[day]; }
function checkedCount() { return Object.keys(getChecked()).length; }

// ============================================================
//  Init
// ============================================================
function init() {
    renderCalendarGrid();
    renderDayList();
    const user = getUser();
    if (user) showLoggedIn(user);

    document.getElementById('nameInput').addEventListener('keydown', e => {
        if (e.key === 'Enter') login();
    });
}

function login() {
    const name = document.getElementById('nameInput').value.trim();
    if (!name) { showToast('è«‹è¼¸å…¥ä½ çš„åå­— âœï¸'); return; }
    setUser(name);
    showLoggedIn(name);
    showToast(`æ­¡è¿ä½ ï¼Œ${name}ï¼ğŸ‰`);
}

function logout() {
    removeUser();
    document.getElementById('loginSection').style.display = '';
    document.getElementById('loggedInSection').style.display = 'none';
    document.getElementById('progressDesc').textContent = 'è¼¸å…¥åå­—å³å¯è¨˜éŒ„æ¯æ—¥éˆä¿®æ‰“å¡ï¼Œè¿½è¹¤æ‚¨çš„é€²åº¦';
    document.getElementById('nameInput').value = '';
}

function showLoggedIn(name) {
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('loggedInSection').style.display = '';
    document.getElementById('displayName').textContent = name;
    document.getElementById('progressDesc').style.display = 'none';
    updateProgress();
}

function updateProgress() {
    const count = checkedCount();
    const pct = Math.round((count / 28) * 100);
    document.getElementById('progressBar').style.width = pct + '%';
    document.getElementById('checkedCount').textContent = count;
    document.getElementById('percentText').textContent = pct + '%';

    // Update list items
    document.querySelectorAll('.day-item').forEach(el => {
        const day = el.dataset.day;
        if (isChecked(day)) el.classList.add('checked');
        else el.classList.remove('checked');
    });

    // Update calendar grid
    document.querySelectorAll('.cal-day').forEach(el => {
        const day = el.dataset.day;
        if (day && isChecked(day)) el.classList.add('checked');
        else el.classList.remove('checked');
    });
}

// ============================================================
//  Calendar Grid
// ============================================================
function renderCalendarGrid() {
    const grid = document.getElementById('calendarGrid');
    // Headers
    WEEKDAYS.forEach(w => {
        grid.innerHTML += `<div class="cal-header">${w}</div>`;
    });

    // Feb 1, 2026 is a Sunday (day 0)
    const today = new Date();
    const todayDay = (today.getFullYear() === 2026 && today.getMonth() === 1) ? today.getDate() : -1;

    DAYS_DATA.forEach(d => {
        const isToday = d.day === todayDay;
        const checked = isChecked(d.day);
        const dots = d.categories.map(c => `<div class="cat-dot" style="background:var(--${c === 'connect' ? 'connect-blue' : c === 'care' ? 'care-red' : 'calm-green'})"></div>`).join('');
        grid.innerHTML += `
            <div class="cal-day ${isToday ? 'today' : ''} ${checked ? 'checked' : ''}" 
                 data-day="${d.day}" onclick="openDetail(${d.day})">
                <span class="num">${d.day}</span>
                ${d.lunar ? `<span class="lunar">${d.lunar}</span>` : ''}
                <div class="cat-dots">${dots}</div>
            </div>
        `;
    });
}

// ============================================================
//  Day List
// ============================================================
function renderDayList() {
    const list = document.getElementById('dayList');
    const today = new Date();
    const todayDay = (today.getFullYear() === 2026 && today.getMonth() === 1) ? today.getDate() : -1;

    list.innerHTML = DAYS_DATA.map((d, idx) => {
        const tags = d.categories.map(c => {
            const label = c === 'connect' ? 'Connect' : c === 'care' ? 'Care' : 'Calm';
            return `<span class="tag ${c}">â— ${label}</span>`;
        }).join('');
        const checked = isChecked(d.day);

        return `
            <div class="day-item ${checked ? 'checked' : ''}" 
                 data-day="${d.day}" 
                 style="animation-delay: ${Math.min(idx * 0.04, 0.8)}s"
                 onclick="openDetail(${d.day})">
                <div class="date-col">
                    <div class="date-num">${d.day}</div>
                    <div class="date-weekday">${d.weekday}</div>
                </div>
                <div class="divider"></div>
                <div class="content-col">
                    ${d.lunar ? `<div class="lunar-label">${d.lunar}</div>` : ''}
                    <div class="title">${d.title}</div>
                    <div class="tags">${tags}</div>
                </div>
                <div class="arrow">â€º</div>
            </div>
        `;
    }).join('');
}

// ============================================================
//  Day Detail
// ============================================================
function openDetail(day) {
    const d = DAYS_DATA.find(x => x.day === day);
    if (!d) return;

    const overlay = document.getElementById('detailOverlay');
    const body = document.getElementById('detailBody');
    const headerTitle = document.getElementById('detailHeaderTitle');

    headerTitle.textContent = `2/${d.day} ${d.title}`;

    const tags = d.categories.map(c => {
        const label = c === 'connect' ? 'Connect é€£çµ' : c === 'care' ? 'Care é—œå¿ƒ' : 'Calm å®‰éœ';
        return `<span class="tag ${c}" style="font-size:13px;padding:4px 12px">â— ${label}</span>`;
    }).join('');

    const checked = isChecked(d.day);

    body.innerHTML = `
        <div class="detail-date-badge">
            ğŸ“… 2026 å¹´ 2 æœˆ ${d.day} æ—¥ï¼ˆ${d.weekday}ï¼‰${d.lunar ? ' Â· ' + d.lunar : ''}
        </div>

        <h1 class="detail-title">${d.title}</h1>

        <div class="detail-tags">${tags}</div>

        <div class="detail-section">
            <div class="detail-section-label">ğŸ§˜ éœå¿ƒæ™‚åˆ»</div>
            <div class="detail-quiet">${d.quiet}</div>
        </div>

        <div class="detail-section">
            <div class="detail-section-label">ğŸ“– ä»Šæ—¥ç¶“æ–‡</div>
            <div class="detail-verse">
                <div class="verse-text">${d.verse}</div>
                <div class="verse-ref">â€” ${d.verseRef}</div>
            </div>
        </div>

        <div class="detail-section">
            <div class="detail-section-label">ğŸ™ ç¦±å‘Š</div>
            <div class="detail-prayer">
                <div class="prayer-text">${d.prayer}</div>
            </div>
        </div>

        <button class="detail-checkin-btn ${checked ? 'checked' : ''}" 
                id="checkinBtn" onclick="checkIn(${d.day})">
            ${checked ? 'âœ… å·²å®Œæˆæ‰“å¡' : 'â˜ å®Œæˆä»Šæ—¥éˆä¿®æ‰“å¡'}
        </button>

        <div style="text-align:center; margin-top:16px;">
            <button class="btn btn-outline" onclick="shareDay(${d.day})" style="font-size:13px">
                ğŸ“¤ åˆ†äº«ä»Šæ—¥éˆä¿®
            </button>
        </div>
    `;

    overlay.classList.remove('closing');
    overlay.classList.add('active');
    overlay.scrollTop = 0;
    document.body.style.overflow = 'hidden';
}

function closeDetail() {
    const overlay = document.getElementById('detailOverlay');
    overlay.classList.add('closing');
    setTimeout(() => {
        overlay.classList.remove('active', 'closing');
        document.body.style.overflow = '';
    }, 300);
}

function checkIn(day) {
    if (!getUser()) {
        showToast('è«‹å…ˆè¼¸å…¥åå­—å†æ‰“å¡ âœï¸');
        closeDetail();
        return;
    }
    if (isChecked(day)) return;

    setChecked(day);
    const btn = document.getElementById('checkinBtn');
    btn.classList.add('checked');
    btn.innerHTML = 'âœ… å·²å®Œæˆæ‰“å¡';
    btn.style.animation = 'popIn 0.4s ease';

    updateProgress();
    showConfetti();
    showToast('ğŸ‰ æ‰“å¡æˆåŠŸï¼é¡˜ä¸»è³œç¦ä½ ï¼');
}

function shareDay(day) {
    const d = DAYS_DATA.find(x => x.day === day);
    if (!d) return;
    const text = `ã€3Cé™ªä½ éå¹´ä¸NGã€‘2/${d.day} ${d.title}\n\n${d.verse}\nâ€” ${d.verseRef}\n\nğŸ™ ${d.prayer}`;

    if (navigator.share) {
        navigator.share({ title: `3Céˆä¿® 2/${d.day}`, text }).catch(() => {});
    } else {
        navigator.clipboard.writeText(text).then(() => showToast('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ ğŸ“‹'));
    }
}

// ============================================================
//  Calendar Export
// ============================================================
function addGoogleCal() {
    const url = 'https://calendar.google.com/calendar/render?action=TEMPLATE&text=3Céˆä¿®æœˆæ›†&dates=20260201/20260301&details=3Cé™ªä½ éå¹´ä¸NG+éˆä¿®æœˆæ›†';
    window.open(url, '_blank');
}

function addIphoneCal() {
    // Generate ICS file
    let ics = `BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//3C Calendar//EN
`;
    DAYS_DATA.forEach(d => {
        const dayStr = d.day.toString().padStart(2, '0');
        ics += `BEGIN:VEVENT
DTSTART;VALUE=DATE:202602${dayStr}
SUMMARY:3Céˆä¿®ï¼š${d.title}
DESCRIPTION:${d.verse} ${d.verseRef}
END:VEVENT
`;
    });
    ics += 'END:VCALENDAR';

    const blob = new Blob([ics], { type: 'text/calendar' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = '3Céˆä¿®æœˆæ›†.ics';
    a.click();
    URL.revokeObjectURL(url);
    showToast('æ­£åœ¨ä¸‹è¼‰è¡Œäº‹æ›†æª”æ¡ˆ ğŸ“…');
}

// ============================================================
//  Confetti
// ============================================================
function showConfetti() {
    const colors = ['#C9A84C', '#DC2626', '#16A34A', '#2563EB', '#FFD700', '#FF6B6B'];
    for (let i = 0; i < 20; i++) {
        const piece = document.createElement('div');
        piece.className = 'confetti-piece';
        piece.style.left = (30 + Math.random() * 40) + '%';
        piece.style.top = (40 + Math.random() * 20) + '%';
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDelay = (Math.random() * 0.3) + 's';
        piece.style.animationDuration = (0.8 + Math.random() * 0.6) + 's';
        document.body.appendChild(piece);
        setTimeout(() => piece.remove(), 1500);
    }
}

// ============================================================
//  Toast
// ============================================================
function showToast(msg) {
    const t = document.getElementById('toast');
    t.textContent = msg;
    t.classList.add('show');
    setTimeout(() => t.classList.remove('show'), 2800);
}

// ============================================================
// ============================================================
//  SCRATCH CARD
// ============================================================
let scratchRevealed = false;
let isDrawing = false;
let currentScratchVerse = null;

const SCRATCH_VERSES = [
    { emoji: 'ğŸ“–', verse: 'ã€Œæœ€è¦ç·Šçš„æ˜¯å½¼æ­¤åˆ‡å¯¦ç›¸æ„›ï¼Œå› ç‚ºæ„›èƒ½é®æ©è¨±å¤šçš„ç½ªã€‚ã€', ref: 'å½¼å¾—å‰æ›¸ 4:8', prayer: 'ä¸»è€¶ç©Œï¼Œæ±‚ç¥¢å°‡åˆ‡å¯¦ç›¸æ„›çš„å¿ƒæ”¾åœ¨æˆ‘å€‘ç•¶ä¸­ã€‚é¡˜æ„›é®æ©ééŒ¯ï¼Œä½¿æˆ‘å€‘çš„é—œä¿‚æ›´åŠ å’Œç¦ã€‚' },
    { emoji: 'ğŸ•Šï¸', verse: 'ã€Œä½ å€‘è¦å°‡ä¸€åˆ‡çš„æ†‚æ…®å¸çµ¦ç¥ï¼Œå› ç‚ºä»–é¡§å¿µä½ å€‘ã€‚ã€', ref: 'å½¼å¾—å‰æ›¸ 5:7', prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢æ™‚åˆ»é¡§å¿µæˆ‘å€‘ã€‚å¹«åŠ©æˆ‘å€‘å°‡é‡æ“”äº¤çµ¦ç¥¢ï¼Œåœ¨ç¥¢çš„æ„›ä¸­å¾—è‘—å®‰æ¯ã€‚' },
    { emoji: 'ğŸŒŸ', verse: 'ã€Œæˆ‘ç•™ä¸‹å¹³å®‰çµ¦ä½ å€‘ï¼Œæˆ‘å°‡æˆ‘çš„å¹³å®‰è³œçµ¦ä½ å€‘ã€‚ä½ å€‘å¿ƒè£¡ä¸è¦æ†‚æ„ï¼Œä¹Ÿä¸è¦è†½æ€¯ã€‚ã€', ref: 'ç´„ç¿°ç¦éŸ³ 14:27', prayer: 'ä¸»è€¶ç©Œï¼Œè¬è¬ç¥¢è³œä¸‹è¶…è¶Šä¸–ç•Œçš„å¹³å®‰ã€‚é¡˜é€™å¹³å®‰å……æ»¿æˆ‘å€‘çš„å¿ƒï¼Œä¸å†æ†‚æ„è†½æ€¯ã€‚' },
    { emoji: 'ğŸ’ª', verse: 'ã€Œæˆ‘é è‘—é‚£åŠ çµ¦æˆ‘åŠ›é‡çš„ï¼Œå‡¡äº‹éƒ½èƒ½åšã€‚ã€', ref: 'è…“ç«‹æ¯”æ›¸ 4:13', prayer: 'ä¸»å•Šï¼Œæ„Ÿè¬ç¥¢æ˜¯æˆ‘åŠ›é‡çš„æºé ­ã€‚æ±‚ç¥¢åŠ æ·»æˆ‘åŠ›é‡ï¼Œè®“æˆ‘å‹‡æ•¢é¢å°ä¸€åˆ‡æŒ‘æˆ°ã€‚' },
    { emoji: 'ğŸŒˆ', verse: 'ã€Œè€¶å’Œè¯èªªï¼šæˆ‘çŸ¥é“æˆ‘å‘ä½ å€‘æ‰€æ‡·çš„æ„å¿µï¼Œæ˜¯è³œå¹³å®‰çš„æ„å¿µï¼Œä¸æ˜¯é™ç½ç¦çš„æ„å¿µï¼Œè¦å«ä½ å€‘æœ«å¾Œæœ‰æŒ‡æœ›ã€‚ã€', ref: 'è€¶åˆ©ç±³æ›¸ 29:11', prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢å°æˆ‘å€‘çš„ç¾å¥½è¨ˆåŠƒã€‚æ±‚ç¥¢å¼•å°æˆ‘å€‘çš„è…³æ­¥ï¼Œè¡Œåœ¨ç¥¢çš„æ—¨æ„ä¸­ã€‚' },
    { emoji: 'ğŸ™', verse: 'ã€Œä½ å€‘ç¥ˆæ±‚ï¼Œå°±çµ¦ä½ å€‘ï¼›å°‹æ‰¾ï¼Œå°±å°‹è¦‹ï¼›å©é–€ï¼Œå°±çµ¦ä½ å€‘é–‹é–€ã€‚ã€', ref: 'é¦¬å¤ªç¦éŸ³ 7:7', prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢è†è½æˆ‘å€‘çš„ç¦±å‘Šã€‚è³œæˆ‘å€‘ä¿¡å¿ƒï¼Œæ›´å¤šä¾†åˆ°ç¥¢é¢å‰å°‹æ±‚ã€‚' },
    { emoji: 'â˜€ï¸', verse: 'ã€Œä½†é‚£ç­‰å€™è€¶å’Œè¯çš„ï¼Œå¿…é‡æ–°å¾—åŠ›ã€‚ä»–å€‘å¿…å¦‚é·¹å±•ç¿…ä¸Šé¨°ã€‚ã€', ref: 'ä»¥è³½äºæ›¸ 40:31', prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢æ•™å°æˆ‘å€‘åœ¨å¿™ç¢Œä¸­å­¸æœƒç­‰å€™ï¼Œåœ¨ç¥¢è£¡é¢é‡æ–°å¾—åŠ›ã€‚' },
    { emoji: 'â¤ï¸', verse: 'ã€Œç¥æ„›ä¸–äººï¼Œç”šè‡³å°‡ä»–çš„ç¨ç”Ÿå­è³œçµ¦ä»–å€‘ï¼Œå«ä¸€åˆ‡ä¿¡ä»–çš„ï¼Œä¸è‡³æ»…äº¡ï¼Œåå¾—æ°¸ç”Ÿã€‚ã€', ref: 'ç´„ç¿°ç¦éŸ³ 3:16', prayer: 'å¤©çˆ¶ï¼Œæ„Ÿè¬ç¥¢ç„¡æ¢ä»¶çš„æ„›ã€‚é¡˜æˆ‘å€‘æ›´æ·±ç¶“æ­·ç¥¢çš„æ„›ï¼Œä¹Ÿå°‡é€™ä»½æ„›åˆ†äº«å‡ºå»ã€‚' },
    { emoji: 'ğŸŒ¿', verse: 'ã€Œæ‡‰ç•¶ä¸€ç„¡æ›æ…®ï¼Œåªè¦å‡¡äº‹è—‰è‘—ç¦±å‘Šã€ç¥ˆæ±‚å’Œæ„Ÿè¬ï¼Œå°‡ä½ å€‘æ‰€è¦çš„å‘Šè¨´ç¥ã€‚ã€', ref: 'è…“ç«‹æ¯”æ›¸ 4:6', prayer: 'ä¸»å•Šï¼Œå¹«åŠ©æˆ‘å€‘å­¸æœƒå‡¡äº‹äº¤è¨—ã€‚é¡˜æˆ‘å€‘ç”¨æ„Ÿæ©çš„å¿ƒé¢å°æ¯ä¸€å¤©ã€‚' },
    { emoji: 'ğŸ”¥', verse: 'ã€Œè€¶å’Œè¯æ˜¯æˆ‘çš„ç‰§è€…ï¼Œæˆ‘å¿…ä¸è‡´ç¼ºä¹ã€‚ã€', ref: 'è©©ç¯‡ 23:1', prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢åšæˆ‘å€‘çš„å¥½ç‰§è€…ã€‚æ±‚ç¥¢å¸¶é ˜æˆ‘å€‘èµ°éæ¯ä¸€å¤©ã€‚' },
    { emoji: 'ğŸµ', verse: 'ã€Œä½ å€‘è¦å˜—å˜—ä¸»æ©çš„æ»‹å‘³ï¼Œä¾¿çŸ¥é“ä»–æ˜¯ç¾å–„ï¼›æŠ•é ä»–çš„äººæœ‰ç¦äº†ï¼ã€', ref: 'è©©ç¯‡ 34:8', prayer: 'å¤©çˆ¶ï¼Œæ±‚ç¥¢é–‹æˆ‘å€‘çš„çœ¼ç›ï¼Œè®“æˆ‘å€‘å“åšç¥¢çš„æ©å…¸ï¼Œç¶“æ­·ç¥¢çš„ç¾å–„ã€‚' },
    { emoji: 'ğŸŒ¸', verse: 'ã€Œå–œæ¨‚çš„å¿ƒä¹ƒæ˜¯è‰¯è—¥ï¼›æ†‚å‚·çš„éˆä½¿éª¨æ¯ä¹¾ã€‚ã€', ref: 'ç®´è¨€ 17:22', prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢å°‡å–œæ¨‚çš„å¿ƒè³œçµ¦æˆ‘å€‘ã€‚é¡˜å–œæ¨‚å¾ç¥¢è€Œä¾†ï¼Œæˆç‚ºé†«æ²»å’Œç¥ç¦ã€‚' },
    { emoji: 'â­', verse: 'ã€Œä½ çš„è©±æ˜¯æˆ‘è…³å‰çš„ç‡ˆï¼Œæ˜¯æˆ‘è·¯ä¸Šçš„å…‰ã€‚ã€', ref: 'è©©ç¯‡ 119:105', prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢çš„è©±èªç…§äº®äººç”Ÿã€‚æ±‚ç¥¢å¸¶é ˜æˆ‘å€‘æ›´å¤šè¦ªè¿‘ç¥¢çš„è©±èªã€‚' },
    { emoji: 'ğŸ«¶', verse: 'ã€Œæ„›æ˜¯æ†ä¹…å¿è€ï¼Œåˆæœ‰æ©æ…ˆï¼›æ„›æ˜¯ä¸å«‰å¦’ï¼Œæ„›æ˜¯ä¸è‡ªèª‡ï¼Œä¸å¼µç‹‚ã€‚ã€', ref: 'å“¥æ—å¤šå‰æ›¸ 13:4', prayer: 'ä¸»å•Šï¼Œæ±‚ç¥¢å°‡çœŸå¯¦çš„æ„›æ¾†çŒåœ¨æˆ‘å€‘å¿ƒä¸­ã€‚é¡˜æˆ‘å€‘å­¸åƒåŸºç£å»æ„›èº«é‚Šçš„äººã€‚' },
    { emoji: 'ğŸ•¯ï¸', verse: 'ã€Œåœ¨ä¸–ä¸Šä½ å€‘æœ‰è‹¦é›£ï¼Œä½†ä½ å€‘å¯ä»¥æ”¾å¿ƒï¼Œæˆ‘å·²ç¶“å‹äº†ä¸–ç•Œã€‚ã€', ref: 'ç´„ç¿°ç¦éŸ³ 16:33', prayer: 'ä¸»è€¶ç©Œï¼Œæ„Ÿè¬ç¥¢å·²ç¶“å¾—å‹ã€‚ç„¡è«–é‡åˆ°ä»€éº¼å›°é›£ï¼Œå¹«åŠ©æˆ‘å€‘å€šé ç¥¢å¾—è‘—å¹³å®‰ã€‚' }
];

function loadScratchCard() {
    currentScratchVerse = SCRATCH_VERSES[Math.floor(Math.random() * SCRATCH_VERSES.length)];
    scratchRevealed = false;
    document.getElementById('scEmoji').textContent = currentScratchVerse.emoji;
    document.getElementById('scVerse').textContent = currentScratchVerse.verse;
    document.getElementById('scRef').textContent = currentScratchVerse.ref;
    document.getElementById('scPrayer').textContent = currentScratchVerse.prayer;
    document.getElementById('scratchActions').style.display = 'none';
    document.getElementById('scratchHint').classList.remove('hidden');
    const canvas = document.getElementById('scratchCanvas');
    canvas.style.display = '';
    canvas.style.opacity = '1';
    setTimeout(() => initScratchCanvas(), 150);
}

function initScratchCanvas() {
    const canvas = document.getElementById('scratchCanvas');
    const card = document.getElementById('scratchCard');
    if (!card.offsetWidth) return;
    const ctx = canvas.getContext('2d');
    const dpr = window.devicePixelRatio || 1;
    canvas.width = card.offsetWidth * dpr;
    canvas.height = card.offsetHeight * dpr;
    canvas.style.width = card.offsetWidth + 'px';
    canvas.style.height = card.offsetHeight + 'px';
    ctx.scale(dpr, dpr);
    const w = card.offsetWidth, h = card.offsetHeight;

    const grad = ctx.createLinearGradient(0, 0, w, h);
    grad.addColorStop(0, '#C9A84C');
    grad.addColorStop(0.3, '#E8D48B');
    grad.addColorStop(0.5, '#C9A84C');
    grad.addColorStop(0.7, '#A07D2E');
    grad.addColorStop(1, '#8B6914');
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, w, h);

    ctx.save(); ctx.globalAlpha = 0.1;
    for (let i = 0; i < 15; i++) {
        ctx.beginPath();
        ctx.arc(Math.random() * w, Math.random() * h, 15 + Math.random() * 35, 0, Math.PI * 2);
        ctx.fillStyle = '#fff'; ctx.fill();
    }
    ctx.restore();

    ctx.fillStyle = 'rgba(255,255,255,0.9)';
    ctx.font = `bold ${Math.min(w * 0.065, 24)}px 'Noto Serif TC', serif`;
    ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
    ctx.fillText('âœ¨ ç¥ç¦åˆ®åˆ®åŒ… âœ¨', w / 2, h / 2 - 14);
    ctx.font = `${Math.min(w * 0.038, 14)}px 'Noto Sans TC', sans-serif`;
    ctx.fillStyle = 'rgba(255,255,255,0.7)';
    ctx.fillText('ç”¨æ‰‹æŒ‡åˆ®é–‹é ˜å–ç¥ç¦', w / 2, h / 2 + 16);
    ctx.globalCompositeOperation = 'destination-out';
    isDrawing = false;

    canvas.onmousedown = e => startScratch(e, canvas, ctx);
    canvas.onmousemove = e => doScratch(e, canvas, ctx);
    canvas.onmouseup = () => { isDrawing = false; checkScratchReveal(canvas); };
    canvas.onmouseleave = () => { isDrawing = false; };
    canvas.ontouchstart = e => { e.preventDefault(); startScratch(e.touches[0], canvas, ctx); };
    canvas.ontouchmove = e => { e.preventDefault(); doScratch(e.touches[0], canvas, ctx); };
    canvas.ontouchend = () => { isDrawing = false; checkScratchReveal(canvas); };
}

function getScratchPos(e, canvas) {
    const rect = canvas.getBoundingClientRect();
    return { x: e.clientX - rect.left, y: e.clientY - rect.top };
}

function startScratch(e, canvas, ctx) {
    isDrawing = true;
    const pos = getScratchPos(e, canvas);
    ctx.beginPath(); ctx.moveTo(pos.x, pos.y);
    document.getElementById('scratchHint').classList.add('hidden');
}

function doScratch(e, canvas, ctx) {
    if (!isDrawing) return;
    const pos = getScratchPos(e, canvas);
    ctx.lineWidth = 36; ctx.lineCap = 'round'; ctx.lineJoin = 'round';
    ctx.lineTo(pos.x, pos.y); ctx.stroke();
    ctx.beginPath(); ctx.moveTo(pos.x, pos.y);
    checkScratchReveal(canvas);
}

function checkScratchReveal(canvas) {
    if (scratchRevealed) return;
    const ctx = canvas.getContext('2d');
    const pixels = ctx.getImageData(0, 0, canvas.width, canvas.height).data;
    let transparent = 0;
    for (let i = 3; i < pixels.length; i += 16) { if (pixels[i] === 0) transparent++; }
    if (transparent / (pixels.length / 16) > 0.45) revealScratch(canvas);
}

function revealScratch(canvas) {
    scratchRevealed = true;
    canvas.style.transition = 'opacity 0.8s ease';
    canvas.style.opacity = '0';
    setTimeout(() => { canvas.style.display = 'none'; }, 800);
    document.getElementById('scratchActions').style.display = 'flex';
    showConfetti();
    showToast('ğŸ‰ é¡˜ä¸Šå¸ç¥ç¦ä½ ï¼');
}

function scratchAgain() {
    loadScratchCard();
    document.getElementById('scratchSection').scrollIntoView({ behavior: 'smooth', block: 'center' });
}

function shareScratch() {
    if (!currentScratchVerse) return;
    const text = `${currentScratchVerse.verse}\nâ€” ${currentScratchVerse.ref}\n\nğŸ™ ${currentScratchVerse.prayer}\n\nâœ¨ ä¾†è‡ªã€Œ3Cé™ªä½ éå¹´ä¸NGã€çš„ç¥ç¦`;
    if (navigator.share) { navigator.share({ title: 'å±¬éˆç¥ç¦åˆ®åˆ®åŒ…', text }).catch(() => {}); }
    else { navigator.clipboard.writeText(text).then(() => showToast('å·²è¤‡è£½åˆ°å‰ªè²¼ç°¿ ğŸ“‹')); }
}

//  Back button / ESC
// ============================================================
window.addEventListener('keydown', e => {
    if (e.key === 'Escape') closeDetail();
});

window.addEventListener('popstate', () => {
    if (document.getElementById('detailOverlay').classList.contains('active')) {
        closeDetail();
    }
});

// ============================================================
//  Boot
// ============================================================
document.addEventListener('DOMContentLoaded', init);

// Load scratch card after DOM ready
document.addEventListener('DOMContentLoaded', () => {
    loadScratchCard();
});

// Handle resize for scratch canvas
let scratchResizeTimer;
window.addEventListener('resize', () => {
    clearTimeout(scratchResizeTimer);
    scratchResizeTimer = setTimeout(() => {
        if (!scratchRevealed) initScratchCanvas();
    }, 200);
});
</script>

</body>
</html>